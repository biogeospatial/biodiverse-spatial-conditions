<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Functions â€“ Biodiverse Spatial Conditions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./variables.html" rel="next">
<link href="./overview.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-fbb27ab3f4425a88d9682c2047e7f75c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spatial_conditions.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Biodiverse Spatial Conditions</a> 
        <div class="sidebar-tools-main">
    <a href="./Biodiverse-Spatial-Conditions.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial_conditions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variables</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#available-functions" id="toc-available-functions" class="nav-link active" data-scroll-target="#available-functions"><span class="header-section-number">3.1</span> Available functions</a>
  <ul class="collapse">
  <li><a href="#sp_annulus" id="toc-sp_annulus" class="nav-link" data-scroll-target="#sp_annulus">sp_annulus</a></li>
  <li><a href="#sp_block" id="toc-sp_block" class="nav-link" data-scroll-target="#sp_block">sp_block</a></li>
  <li><a href="#sp_circle" id="toc-sp_circle" class="nav-link" data-scroll-target="#sp_circle">sp_circle</a></li>
  <li><a href="#sp_circle_cell" id="toc-sp_circle_cell" class="nav-link" data-scroll-target="#sp_circle_cell">sp_circle_cell</a></li>
  <li><a href="#sp_ellipse" id="toc-sp_ellipse" class="nav-link" data-scroll-target="#sp_ellipse">sp_ellipse</a></li>
  <li><a href="#sp_get_spatial_output_list_value" id="toc-sp_get_spatial_output_list_value" class="nav-link" data-scroll-target="#sp_get_spatial_output_list_value">sp_get_spatial_output_list_value</a></li>
  <li><a href="#sp_group_not_empty" id="toc-sp_group_not_empty" class="nav-link" data-scroll-target="#sp_group_not_empty">sp_group_not_empty</a></li>
  <li><a href="#sp_in_label_ancestor_range" id="toc-sp_in_label_ancestor_range" class="nav-link" data-scroll-target="#sp_in_label_ancestor_range">sp_in_label_ancestor_range</a></li>
  <li><a href="#sp_in_label_range" id="toc-sp_in_label_range" class="nav-link" data-scroll-target="#sp_in_label_range">sp_in_label_range</a></li>
  <li><a href="#sp_in_line_with" id="toc-sp_in_line_with" class="nav-link" data-scroll-target="#sp_in_line_with">sp_in_line_with</a></li>
  <li><a href="#sp_is_left_of" id="toc-sp_is_left_of" class="nav-link" data-scroll-target="#sp_is_left_of">sp_is_left_of</a></li>
  <li><a href="#sp_is_right_of" id="toc-sp_is_right_of" class="nav-link" data-scroll-target="#sp_is_right_of">sp_is_right_of</a></li>
  <li><a href="#sp_match_regex" id="toc-sp_match_regex" class="nav-link" data-scroll-target="#sp_match_regex">sp_match_regex</a></li>
  <li><a href="#sp_match_text" id="toc-sp_match_text" class="nav-link" data-scroll-target="#sp_match_text">sp_match_text</a></li>
  <li><a href="#sp_point_in_cluster" id="toc-sp_point_in_cluster" class="nav-link" data-scroll-target="#sp_point_in_cluster">sp_point_in_cluster</a></li>
  <li><a href="#sp_point_in_poly" id="toc-sp_point_in_poly" class="nav-link" data-scroll-target="#sp_point_in_poly">sp_point_in_poly</a></li>
  <li><a href="#sp_point_in_poly_shape" id="toc-sp_point_in_poly_shape" class="nav-link" data-scroll-target="#sp_point_in_poly_shape">sp_point_in_poly_shape</a></li>
  <li><a href="#sp_points_in_same_cluster" id="toc-sp_points_in_same_cluster" class="nav-link" data-scroll-target="#sp_points_in_same_cluster">sp_points_in_same_cluster</a></li>
  <li><a href="#sp_points_in_same_poly_shape" id="toc-sp_points_in_same_poly_shape" class="nav-link" data-scroll-target="#sp_points_in_same_poly_shape">sp_points_in_same_poly_shape</a></li>
  <li><a href="#sp_rectangle" id="toc-sp_rectangle" class="nav-link" data-scroll-target="#sp_rectangle">sp_rectangle</a></li>
  <li><a href="#sp_redundancy_greater_than" id="toc-sp_redundancy_greater_than" class="nav-link" data-scroll-target="#sp_redundancy_greater_than">sp_redundancy_greater_than</a></li>
  <li><a href="#sp_richness_greater_than" id="toc-sp_richness_greater_than" class="nav-link" data-scroll-target="#sp_richness_greater_than">sp_richness_greater_than</a></li>
  <li><a href="#sp_select_all" id="toc-sp_select_all" class="nav-link" data-scroll-target="#sp_select_all">sp_select_all</a></li>
  <li><a href="#sp_select_block" id="toc-sp_select_block" class="nav-link" data-scroll-target="#sp_select_block">sp_select_block</a></li>
  <li><a href="#sp_select_element" id="toc-sp_select_element" class="nav-link" data-scroll-target="#sp_select_element">sp_select_element</a></li>
  <li><a href="#sp_select_sequence" id="toc-sp_select_sequence" class="nav-link" data-scroll-target="#sp_select_sequence">sp_select_sequence</a></li>
  <li><a href="#sp_self_only" id="toc-sp_self_only" class="nav-link" data-scroll-target="#sp_self_only">sp_self_only</a></li>
  <li><a href="#sp_spatial_output_passed_defq" id="toc-sp_spatial_output_passed_defq" class="nav-link" data-scroll-target="#sp_spatial_output_passed_defq">sp_spatial_output_passed_defq</a></li>
  <li><a href="#sp_square" id="toc-sp_square" class="nav-link" data-scroll-target="#sp_square">sp_square</a></li>
  <li><a href="#sp_square_cell" id="toc-sp_square_cell" class="nav-link" data-scroll-target="#sp_square_cell">sp_square_cell</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Functions are the easiest way to specify conditions as one does not need to wrestle with variables. Functions also set metadata to tell the system how to use the spatial index. The <a href="https://biogeospatial.github.io/biodiverse-quick-start/5-data-analysis.html#building-a-spatial-index" class="external" target="&quot;_blank&quot;">spatial index</a> saves considerable processing time for large data sets as the system does not need to test many pairs of index blocks to determine which to use. If you use a function for which an index will produce erroneous results then the system sets a flag to ignore it. You can also disable it in the settings for a spatial condition.</p>
<section id="available-functions" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="available-functions"><span class="header-section-number">3.1</span> Available functions</h2>
<p>The available functions in version 5.0 are: <a href="#sp_annulus"><em>sp_annulus</em></a>, <a href="#sp_block"><em>sp_block</em></a>, <a href="#sp_circle"><em>sp_circle</em></a>, <a href="#sp_circle_cell"><em>sp_circle_cell</em></a>, <a href="#sp_ellipse"><em>sp_ellipse</em></a>, <a href="#sp_get_spatial_output_list_value"><em>sp_get_spatial_output_list_value</em></a>, <a href="#sp_group_not_empty"><em>sp_group_not_empty</em></a>, <a href="#sp_in_label_ancestor_range"><em>sp_in_label_ancestor_range</em></a>, <a href="#sp_in_label_range"><em>sp_in_label_range</em></a>, <a href="#sp_in_line_with"><em>sp_in_line_with</em></a>, <a href="#sp_is_left_of"><em>sp_is_left_of</em></a>, <a href="#sp_is_right_of"><em>sp_is_right_of</em></a>, <a href="#sp_match_regex"><em>sp_match_regex</em></a>, <a href="#sp_match_text"><em>sp_match_text</em></a>, <a href="#sp_point_in_cluster"><em>sp_point_in_cluster</em></a>, <a href="#sp_point_in_poly"><em>sp_point_in_poly</em></a>, <a href="#sp_point_in_poly_shape"><em>sp_point_in_poly_shape</em></a>, <a href="#sp_points_in_same_cluster"><em>sp_points_in_same_cluster</em></a>, <a href="#sp_points_in_same_poly_shape"><em>sp_points_in_same_poly_shape</em></a>, <a href="#sp_rectangle"><em>sp_rectangle</em></a>, <a href="#sp_redundancy_greater_than"><em>sp_redundancy_greater_than</em></a>, <a href="#sp_richness_greater_than"><em>sp_richness_greater_than</em></a>, <a href="#sp_select_all"><em>sp_select_all</em></a>, <a href="#sp_select_block"><em>sp_select_block</em></a>, <a href="#sp_select_element"><em>sp_select_element</em></a>, <a href="#sp_select_sequence"><em>sp_select_sequence</em></a>, <a href="#sp_self_only"><em>sp_self_only</em></a>, <a href="#sp_spatial_output_passed_defq"><em>sp_spatial_output_passed_defq</em></a>, <a href="#sp_square"><em>sp_square</em></a>, <a href="#sp_square_cell"><em>sp_square_cell</em></a>,</p>
<section id="sp_annulus" class="level3">
<h3 class="anchored" data-anchor-id="sp_annulus">sp_annulus</h3>
<p>An annulus. Assessed against all dimensions by default but use the optional "axes =&gt; []" arg to specify a subset. Uses group (map) distances.</p>
<p><strong>Required args:</strong> inner_radius, outer_radius</p>
<p><strong>Optional args:</strong> axes</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  an annulus assessed against all axes</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sp_annulus (inner_radius =&gt; <span class="dv">2000000</span>, outer_radius =&gt; <span class="dv">4000000</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  an annulus assessed against axes 0 and 1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sp_annulus (inner_radius =&gt; <span class="dv">2000000</span>, outer_radius =&gt; <span class="dv">4000000</span>, axes =&gt; [<span class="dv">0</span>,<span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_block" class="level3">
<h3 class="anchored" data-anchor-id="sp_block">sp_block</h3>
<p>A non-overlapping block. Set an axis to undef to ignore it.</p>
<p><strong>Required args:</strong> size</p>
<p><strong>Optional args:</strong> origin</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sp_block (size =&gt; <span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sp_block (size =&gt; [<span class="dv">3</span>,<span class="fu">undef</span>,<span class="dv">5</span>]) <span class="co">#  rectangular block, ignores second axis</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_circle" class="level3">
<h3 class="anchored" data-anchor-id="sp_circle">sp_circle</h3>
<p>A circle. Assessed against all dimensions by default (more properly called a hypersphere) but you can use the optional <code>axes =&gt; []</code> arg to specify a subset. Uses group (map) distances.</p>
<p><strong>Required args:</strong> radius</p>
<p><strong>Optional args:</strong> axes</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  A circle of radius 1000 across all axes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sp_circle (radius =&gt; <span class="dv">1000</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  use only axes 0 and 3</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>sp_circle (radius =&gt; <span class="dv">1000</span>, axes =&gt; [<span class="dv">0</span>, <span class="dv">3</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_circle_cell" class="level3">
<h3 class="anchored" data-anchor-id="sp_circle_cell">sp_circle_cell</h3>
<p>A circle. Assessed against all dimensions by default (more properly called a hypersphere) but you can use the optional <code>axes =&gt; []</code> arg to specify a subset. Uses cell (map) distances.</p>
<p><strong>Required args:</strong> radius</p>
<p><strong>Optional args:</strong> <em>none</em></p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  A circle of radius 3 cells across all axes</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sp_circle (radius =&gt; <span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  use only axes 0 and 3</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sp_circle_cell (radius =&gt; <span class="dv">3</span>, axes =&gt; [<span class="dv">0</span>, <span class="dv">3</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_ellipse" class="level3">
<h3 class="anchored" data-anchor-id="sp_ellipse">sp_ellipse</h3>
<p>A two dimensional ellipse. Use the <code>axes</code> argument to control which are used (default is <code>[0,1]</code>). The default rotate_angle is 0, such that the major axis is east-west.</p>
<p><strong>Required args:</strong> major_radius, minor_radius</p>
<p><strong>Optional args:</strong> axes, rotate_angle, rotate_angle_deg</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># North-south aligned ellipse</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sp_ellipse (</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    major_radius =&gt; <span class="dv">300000</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    minor_radius =&gt; <span class="dv">100000</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    axes         =&gt; [<span class="dv">0</span>,<span class="dv">1</span>],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    rotate_angle =&gt; <span class="fl">1.5714</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_get_spatial_output_list_value" class="level3">
<h3 class="anchored" data-anchor-id="sp_get_spatial_output_list_value">sp_get_spatial_output_list_value</h3>
<p>Obtain a value from a list in a previously calculated spatial output.</p>
<p><strong>Required args:</strong> index, output</p>
<p><strong>Optional args:</strong> element, list, no_error_if_no_index</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Get the spatial results value for the current neighbour group</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (or processing group if used as a def query)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sp_get_spatial_output_list_value (</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    output  =&gt; <span class="ot">'</span><span class="ss">sp1</span><span class="ot">'</span>,              <span class="co">#  using spatial output called sp1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    list    =&gt; <span class="ot">'</span><span class="ss">SPATIAL_RESULTS</span><span class="ot">'</span>,  <span class="co">#  from the SPATIAL_RESULTS list</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">index</span>   =&gt; <span class="ot">'</span><span class="ss">PE_WE_P</span><span class="ot">'</span>,          <span class="co">#  get index value for PE_WE_P</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  Get the spatial results value for group 128:254</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  Note that the SPATIAL_OUTPUTS list is assumed if</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  no 'list' arg is passed.</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>sp_get_spatial_output_list_value (</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    output  =&gt; <span class="ot">'</span><span class="ss">sp1</span><span class="ot">'</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    element =&gt; <span class="ot">'</span><span class="ss">128:254</span><span class="ot">'</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">index</span>   =&gt; <span class="ot">'</span><span class="ss">PE_WE_P</span><span class="ot">'</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_group_not_empty" class="level3">
<h3 class="anchored" data-anchor-id="sp_group_not_empty">sp_group_not_empty</h3>
<p>Is a basedata group non-empty? (i.e.&nbsp;contains one or more labels)</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> element</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Restrict calculations to those non-empty groups.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  Will use the processing group if a def query,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  the neighbour group otherwise.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sp_group_not_empty ()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The same as above, but being specific about which group (element) to test.</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  This is probably best used in cases where the element</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  to check is varied spatially.}</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>sp_group_not_empty (element =&gt; <span class="ot">'</span><span class="ss">5467:9876</span><span class="ot">'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_in_label_ancestor_range" class="level3">
<h3 class="anchored" data-anchor-id="sp_in_label_ancestor_range">sp_in_label_ancestor_range</h3>
<p>(Available from version 5.1)</p>
<p>Is a group within the range of a label's ancestor?</p>
<p>Returns true if the group falls within the range of any of the any of the ancestor's terminal descendant ranges. The range is by default defined as the set of groups in the basedata containing that label. Polygons can also be specified (see below).</p>
<p>The ancestor is by default defined by length along the path to the root node. Setting the <code>by_depth</code> option to true uses the number of ancestors. The <code>by_tip_count</code> option finds the first ancestor with at least the target number of tips while <code>by_desc_count</code> uses the number of descendants (tips and internals). The <code>by_len_sum</code> finds the first ancestor for which the sum of its descendant branch lengths plus its own length is greater than the target.</p>
<p>Negative target values with <code>by_length</code> or <code>by_depth</code> search the path from the root to the specified node. However, if a <code>by_*_count</code> option is used then a negative <code>target</code> is treated as zero and returns the specified label range is returned.</p>
<p>The <code>target</code> argument determines how far up or down the tree the ancestor is searched for. When using length, the distance includes the tipwards extent of the branch. The depth is calculated as the number of ancestors.</p>
<p>If the <code>target</code> value exceeds that to (or of) the root node then the root or label node is returned for positive or negative dist values, respectively.</p>
<p>An internal branch can be specified as the label. Specifying a <code>target</code> of 0 for an internal node is one means to use the range of an internal node.</p>
<p>Returns false if the label is not associated with a node on the tree.</p>
<p>When the <code>as_frac</code> argument is true then target is treated as a fraction of the distance to the root node, the number of tips, or the sum of all branches, as appropriate.</p>
<p>If the <code>eq</code> argument is true then the branch lengths are all treated as of equal length (the mean of the non-zero branch lengths), although zero length branches remain zero. This is the same as the alternate tree used in CANAPE.</p>
<p>If the <code>rw</code> argument is true then the branches are range weighted. This is the same as the range weighted tree in CANAPE. When both <code>eq</code> and <code>rw</code> are true then this is the same as the range weighted alternate tree in CANAPE</p>
<p>The underlying algorithm checks each of the terminal ranges using <a href="#sp_in_label_range">sp_in_label_range()</a>. This means the search can also use the convex/concave hull or circumcircle of each terminal, as well as setting other arguments such as the <code>buffer_dist</code> and using a default label in some circumstances.</p>
<p>Note that the range of each of the ancestor's tips is assessed separately, i.e.&nbsp;the union of the hulls/circles is used. The ranges are not aggregated before a hull or circumcircle is calculated.</p>
<p><strong>Required args:</strong> label, target</p>
<p><strong>Optional args:</strong> allow_holes, as_frac, axes, buffer_dist, by_depth, by_tip_count, circumcircle, concave_hull, convex_hull, hull_ratio, type</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Are we in the range of an ancestor of Genus:Sp1?</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(label =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>, target =&gt; <span class="fl">0.5</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Are we in the range of the "grandmother" of Genus:Sp1?</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  label    =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  target   =&gt; <span class="dv">2</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  by_depth =&gt; <span class="dv">1</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Are we in the range of the first ancestor with 6 or more tips?</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  label        =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  target       =&gt; <span class="dv">6</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  by_tip_count =&gt; <span class="dv">1</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in any of the tips' convex hulls?</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  label       =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  target      =&gt; <span class="fl">0.5</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  convex_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in any of the tips' concave hulls with a ratio parameter of 0.5?</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  label        =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  target       =&gt; <span class="fl">0.5</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  concave_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  hull_ratio   =&gt; <span class="fl">0.5</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in any of the tips' circumscribing circles?</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  label        =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  target       =&gt; <span class="fl">0.5</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  circumcircle =&gt; <span class="dv">1</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the range of the ancestor for which the sum of</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#  branch lengths below and including it is 10,000?</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  label      =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  target     =&gt; <span class="dv">10000</span>,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  by_len_sum =&gt; <span class="dv">1</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the range of the ancestor for which the sum of</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  number of branches below is at least 10?</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>sp_in_label_ancestor_range(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  label      =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  target     =&gt; <span class="dv">10</span>,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  by_desc_count =&gt; <span class="dv">1</span>,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_in_label_range" class="level3">
<h3 class="anchored" data-anchor-id="sp_in_label_range">sp_in_label_range</h3>
<p>(Available from version 5.1)</p>
<p>Is a group within a label's range?</p>
<p>This is by default assessed as a check of whether the label is found in the processing group but can be generalised by using the <code>convex_hull</code>, <code>concave_hull</code> or <code>circumcircle</code> arguments.</p>
<p>The <code>type</code> argument determines if the processing or neighbour group is assessed. Normally this can be left as the default.</p>
<p>The <code>convex_hull</code> returns true if the processing group is within the convex hull defined by the groups that form the label range.</p>
<p>The <code>circumcircle</code> returns true if the processing group is within the minimum circumscribing circle that includes all of the label range groups.</p>
<p>The <code>concave_hull</code> returns true if the processing group is within the concave hull defined by the groups that form the label range. The concavity can be controlled by the <code>hull_ratio</code> argument, and holes can be allowed by setting the boolean argument <code>allow_holes</code> to a true value.</p>
<p>Both the latter two arguments use the first two axes by default and will return an error if there is only one group axis in the basedata. If you have more than two axes and wish to assess different ones then pass the axes argument. (This argument is ignored for the default case as it does a direct comparison of the group names).</p>
<p>If more than one of <code>convex_hull</code>, <code>concave_hull</code> and <code>circumcircle</code> arguments are passed then only one i run. The convex hull takes priority, followed by the circumcircle, and lastly the concave hull.</p>
<p>An optional <code>buffer_dist</code> argument can be used to adjust the size of the convex/concave hull or circumcircle. As is standard with GIS buffering, positive values increase the area while negative values shrink it.</p>
<p>The <code>label</code> argument should normally be specified but in some circumstances a default is set (e.g.&nbsp;when a randomisation seed location is set).</p>
<p><strong>Required args:</strong> label</p>
<p><strong>Optional args:</strong> allow_holes, axes, buffer_dist, circumcircle, concave_hull, convex_hull, hull_ratio, type</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Are we in the range of label called Genus:Sp1?</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(label =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the convex hull?</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(label =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>, convex_hull =&gt; <span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the maximally concave hull?</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(label =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>, concave_hull =&gt; <span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in a slightly less concave hull?</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(label =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>, concave_hull =&gt; <span class="dv">1</span>, hull_ratio =&gt; <span class="fl">0.3</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in a slightly less concave hull allowing for holes?</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    label        =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    concave_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    hull_ratio   =&gt; <span class="fl">0.3</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    allow_holes  =&gt; <span class="dv">1</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the circumscribing circle?</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(label =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>, circumcircle =&gt; <span class="dv">1</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the convex hull with a buffer of 100,000 units?</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    label       =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    convex_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    buffer_dist =&gt; <span class="dv">100000</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#  Buffers can be negative, in which case the</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  convex/concave hull or circumcircle is shrunk</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    label       =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    convex_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    buffer_dist =&gt; -<span class="dv">100000</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#  Are we in the convex hull defined using the</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#  coordinates from the third and first axes?</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    label       =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    convex_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    axes        =&gt; [<span class="dv">2</span>,<span class="dv">0</span>],</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#  A convex hull with holes and "half" concave.</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>sp_in_label_range(</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    label        =&gt; <span class="ot">'</span><span class="ss">Genus:Sp1</span><span class="ot">'</span>,</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    concave_hull =&gt; <span class="dv">1</span>,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    allow_holes  =&gt; <span class="dv">1</span>,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    hull_ratio   =&gt; <span class="fl">0.5</span>,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_in_line_with" class="level3">
<h3 class="anchored" data-anchor-id="sp_in_line_with">sp_in_line_with</h3>
<p>Are we in line with a vector radiating out from the processing cell? Use the <code>axes</code> argument to control which are used (default is <code>[0,1]</code>).</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> axes, vector_angle, vector_angle_deg</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sp_in_line_with (vector_angle =&gt; <span class="fu">Math::Trig</span>::<span class="fu">pip2</span>) <span class="co">#  pi/2 = 90 degree angle</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_is_left_of" class="level3">
<h3 class="anchored" data-anchor-id="sp_is_left_of">sp_is_left_of</h3>
<p>Are we to the left of a vector radiating out from the processing cell? Use the <code>axes</code> argument to control which are used (default is <code>[0,1]</code>).</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> axes, vector_angle, vector_angle_deg</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sp_is_left_of (vector_angle =&gt; <span class="fl">1.5714</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_is_right_of" class="level3">
<h3 class="anchored" data-anchor-id="sp_is_right_of">sp_is_right_of</h3>
<p>Are we to the right of a vector radiating out from the processing cell? Use the <code>axes</code> argument to control which are used (default is <code>[0,1]</code>).</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> axes, vector_angle, vector_angle_deg</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sp_is_right_of (vector_angle =&gt; <span class="fl">1.5714</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_match_regex" class="level3">
<h3 class="anchored" data-anchor-id="sp_match_regex">sp_match_regex</h3>
<p>Select all neighbours with an axis matching a regular expression</p>
<p><strong>Required args:</strong> re</p>
<p><strong>Optional args:</strong> axis, type</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  use any neighbour where the first axis includes the text "type1"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sp_match_regex (re =&gt; <span class="ot">qr'type1'</span>, axis =&gt; <span class="dv">0</span>, type =&gt; <span class="ot">'</span><span class="ss">nbr</span><span class="ot">'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># match only when the third neighbour axis starts with</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the processing group's second axis</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>sp_match_regex (re =&gt; <span class="ot">qr/</span><span class="ch">^</span><span class="dt">$coord</span><span class="ch">[</span><span class="bn">2</span><span class="ch">]</span><span class="ot">/</span>, axis =&gt; <span class="dv">2</span>, type =&gt; <span class="ot">'</span><span class="ss">nbr</span><span class="ot">'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># match the whole coordinate ID (element name)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># where Biome can be 1 or 2 and the rest of the name contains "dry"</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>sp_match_regex (re =&gt; <span class="ot">qr/</span><span class="ch">^</span><span class="ot">Biome</span><span class="ch">[</span><span class="bn">12</span><span class="ch">]</span><span class="ot">:.</span><span class="ch">+</span><span class="ot">dry/</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a definition query to only use groups where the</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># third axis ends in 'park' (case insensitive)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>sp_match_regex (text =&gt; <span class="ot">qr{park</span><span class="ch">$</span><span class="ot">}i</span>, axis =&gt; <span class="dv">2</span>, type =&gt; <span class="ot">'</span><span class="ss">proc</span><span class="ot">'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_match_text" class="level3">
<h3 class="anchored" data-anchor-id="sp_match_text">sp_match_text</h3>
<p>Select all neighbours matching a text string</p>
<p><strong>Required args:</strong> text</p>
<p><strong>Optional args:</strong> axis, type</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  use any neighbour where the first axis has value of "type1"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sp_match_text (text =&gt; <span class="ot">'</span><span class="ss">type1</span><span class="ot">'</span>, axis =&gt; <span class="dv">0</span>, type =&gt; <span class="ot">'</span><span class="ss">nbr</span><span class="ot">'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># match only when the third neighbour axis is the same</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   as the processing group's second axis</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>sp_match_text (text =&gt; <span class="dt">$coord</span>[<span class="dv">2</span>], axis =&gt; <span class="dv">2</span>, type =&gt; <span class="ot">'</span><span class="ss">nbr</span><span class="ot">'</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># match where the whole coordinate ID (element name)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># is 'Biome1:savannah forest'</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>sp_match_text (text =&gt; <span class="ot">'</span><span class="ss">Biome1:savannah forest</span><span class="ot">'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a definition query to only use groups with 'NK' in the third axis</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>sp_match_text (text =&gt; <span class="ot">'</span><span class="ss">NK</span><span class="ot">'</span>, axis =&gt; <span class="dv">2</span>, type =&gt; <span class="ot">'</span><span class="ss">proc</span><span class="ot">'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_point_in_cluster" class="level3">
<h3 class="anchored" data-anchor-id="sp_point_in_cluster">sp_point_in_cluster</h3>
<p>Returns true when the group is in a cluster or region grower output cluster.</p>
<p><strong>Required args:</strong> output</p>
<p><strong>Optional args:</strong> element, from_node</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Use any element that is a terminal in the cluster output.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  This is useful if the cluster analysis was run under</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  a definition query and you want the same set of groups.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sp_point_in_cluster (</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  output       =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  Now specify a cluster within the output</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>sp_point_in_cluster (</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  output       =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  from_node    =&gt; <span class="ot">'</span><span class="ss">118___</span><span class="ot">'</span>,  <span class="co">#  use the node's name</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  Specify an element to check instead of the current</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  processing element.</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>sp_point_in_cluster (</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  output       =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  from_node    =&gt; <span class="ot">'</span><span class="ss">118___</span><span class="ot">'</span>,  <span class="co">#  use the node's name</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  element      =&gt; <span class="ot">'</span><span class="ss">123:456</span><span class="ot">'</span>, <span class="co">#  specify an element to check</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_point_in_poly" class="level3">
<h3 class="anchored" data-anchor-id="sp_point_in_poly">sp_point_in_poly</h3>
<p>Select groups that occur within a user-defined polygon (see sp_point_in_poly_shape for an alternative)</p>
<p><strong>Required args:</strong> polygon</p>
<p><strong>Optional args:</strong> point</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Is the neighbour coord in a square polygon?</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sp_point_in_poly (</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    polygon =&gt; [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    point   =&gt; \<span class="dt">@nbrcoord</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_point_in_poly_shape" class="level3">
<h3 class="anchored" data-anchor-id="sp_point_in_poly_shape">sp_point_in_poly_shape</h3>
<p>Select groups that occur within a polygon or polygons extracted from a shapefile</p>
<p><strong>Required args:</strong> file</p>
<p><strong>Optional args:</strong> axes, field_name, field_val, no_cache, point</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Is the neighbour coord in a shapefile?</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sp_point_in_poly_shape (</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    file  =&gt; <span class="ot">'</span><span class="ss">c:\biodiverse\data\coastline_lamberts</span><span class="ot">'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    point =&gt; \<span class="dt">@nbrcoord</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Is the neighbour coord in a shapefile's second polygon (counting from 1)?</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>sp_point_in_poly_shape (</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    file      =&gt; <span class="ot">'</span><span class="ss">c:\biodiverse\data\coastline_lamberts</span><span class="ot">'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    field_val =&gt; <span class="dv">2</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    point     =&gt; \<span class="dt">@nbrcoord</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Is the neighbour coord in a polygon with value 2 in the OBJECT_ID field?</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>sp_point_in_poly_shape (</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    file       =&gt; <span class="ot">'</span><span class="ss">c:\biodiverse\data\coastline_lamberts</span><span class="ot">'</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    field_name =&gt; <span class="ot">'</span><span class="ss">OBJECT_ID</span><span class="ot">'</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    field_val  =&gt; <span class="dv">2</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    point      =&gt; \<span class="dt">@nbrcoord</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_points_in_same_cluster" class="level3">
<h3 class="anchored" data-anchor-id="sp_points_in_same_cluster">sp_points_in_same_cluster</h3>
<p>Returns true when two points are within the same cluster or region grower group, or if neither point is in the selected clusters/groups.</p>
<p><strong>Required args:</strong> output</p>
<p><strong>Optional args:</strong> from_node, group_by_depth, num_clusters, target_distance</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Try to use the highest four clusters from the root.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  Note that the next highest number will be used</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  if four is not possible, e.g. there are five</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  siblings below the root.  Fewer will be returned</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  if the tree has insufficient tips.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_cluster (</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  output       =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  num_clusters =&gt; <span class="dv">4</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  Cut the tree at a distance of 0.25 from the tips</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_cluster (</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  output          =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  target_distance =&gt; <span class="fl">0.25</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#  Cut the tree at a depth of 3.</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#  The root is depth 1.</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_cluster (</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  output          =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  target_distance =&gt; <span class="dv">3</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  group_by_depth  =&gt; <span class="dv">1</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  work from an arbitrary node</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_cluster (</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  output       =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  num_clusters =&gt; <span class="dv">4</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  from_node    =&gt; <span class="ot">'</span><span class="ss">118___</span><span class="ot">'</span>,  <span class="co">#  use the node's name</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  target_distance is ignored if num_clusters is set</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_cluster (</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  output          =&gt; <span class="ot">"</span><span class="st">some_cluster_output</span><span class="ot">"</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  num_clusters    =&gt; <span class="dv">4</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  target_distance =&gt; <span class="fl">0.25</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_points_in_same_poly_shape" class="level3">
<h3 class="anchored" data-anchor-id="sp_points_in_same_poly_shape">sp_points_in_same_poly_shape</h3>
<p>Returns true when two points are within the same shapefile polygon</p>
<p><strong>Required args:</strong> file</p>
<p><strong>Optional args:</strong> axes, no_cache, point1, point2</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  define neighbour sets using a shapefile</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_poly_shape (file =&gt; <span class="ot">'</span><span class="ss">path/to/a/shapefile</span><span class="ot">'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  return true when the neighbour coord is in the same</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  polygon as an arbitrary point</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_poly_shape (</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    file   =&gt; <span class="ot">'</span><span class="ss">path/to/a/shapefile</span><span class="ot">'</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    point1 =&gt; [<span class="dv">10</span>,<span class="dv">20</span>],</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  reverse the axes</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_poly_shape (</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    file =&gt; <span class="ot">'</span><span class="ss">path/to/a/shapefile</span><span class="ot">'</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    axes =&gt; [<span class="dv">1</span>,<span class="dv">0</span>],</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#  compare against the second and third axes of your data</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#  e.g. maybe you have time as the first basedata axis</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>sp_points_in_same_poly_shape (</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    file =&gt; <span class="ot">'</span><span class="ss">path/to/a/shapefile</span><span class="ot">'</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    axes =&gt; [<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_rectangle" class="level3">
<h3 class="anchored" data-anchor-id="sp_rectangle">sp_rectangle</h3>
<p>A rectangle. Assessed against all dimensions by default (more properly called a hyperbox) but use the optional <code>axes =&gt; []</code> arg to specify a subset. Uses group (map) distances.</p>
<p><strong>Required args:</strong> sizes</p>
<p><strong>Optional args:</strong> axes</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  A rectangle of equal size on the first two axes,</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  and 100 on the third.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sp_rectangle (sizes =&gt; [<span class="dv">100000</span>, <span class="dv">100000</span>, <span class="dv">100</span>])</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  The same, but with the axes reordered</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  (an example of using the axes argument)</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>sp_rectangle (</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    sizes =&gt; [<span class="dv">100000</span>, <span class="dv">100</span>, <span class="dv">100000</span>],</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    axes  =&gt; [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  Use only the first an third axes</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>sp_rectangle (sizes =&gt; [<span class="dv">100000</span>, <span class="dv">100000</span>], axes =&gt; [<span class="dv">0</span>,<span class="dv">2</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_redundancy_greater_than" class="level3">
<h3 class="anchored" data-anchor-id="sp_redundancy_greater_than">sp_redundancy_greater_than</h3>
<p>Return true if the sample redundancy for an element is greater than the threshold.</p>
<p><strong>Required args:</strong> threshold</p>
<p><strong>Optional args:</strong> element</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Uses the processing group for definition queries,</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  and the neighbour group for spatial conditions.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  In this example, # any group with a redundncy</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  score of 0.5 or fewerless will return false</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>sp_redundancy_greater_than (</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    threshold =&gt; <span class="fl">0.5</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>sp_redundancy_greater_than (</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    element   =&gt; <span class="ot">'</span><span class="ss">128:254</span><span class="ot">'</span>,  <span class="co">#  an arbitrary element</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    threshold =&gt; <span class="fl">0.2</span>,          <span class="co">#  with a threshold of 0.2</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_richness_greater_than" class="level3">
<h3 class="anchored" data-anchor-id="sp_richness_greater_than">sp_richness_greater_than</h3>
<p>Return true if the richness for an element is greater than the threshold.</p>
<p><strong>Required args:</strong> threshold</p>
<p><strong>Optional args:</strong> element</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Uses the processing group for definition queries,</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  and the neigbour group for spatial conditions.</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sp_richness_greater_than (</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    threshold =&gt; <span class="dv">3</span>, <span class="co"># any group with 3 or fewer labels will return false</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sp_richness_greater_than (</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    element   =&gt; <span class="ot">'</span><span class="ss">128:254</span><span class="ot">'</span>,  <span class="co">#  an arbitrary element</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    threshold =&gt; <span class="dv">4</span>,          <span class="co">#  with a threshold of 4</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_select_all" class="level3">
<h3 class="anchored" data-anchor-id="sp_select_all">sp_select_all</h3>
<p>Select all elements as neighbours</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> <em>none</em></p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sp_select_all() <span class="co">#  select every group</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_select_block" class="level3">
<h3 class="anchored" data-anchor-id="sp_select_block">sp_select_block</h3>
<p>Select a subset of all available neighbours based on a block sample sequence</p>
<p><strong>Required args:</strong> size</p>
<p><strong>Optional args:</strong> count, prng_seed, random, reverse_order, use_cache</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select up to two groups per block with each block being 5 groups</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>on a side where the group size is <span class="dv">100</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>sp_select_block (size =&gt; <span class="dv">500</span>, count =&gt; <span class="dv">2</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  Now do it non-randomly and start from the lower right</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>sp_select_block (size =&gt; <span class="dv">500</span>, count =&gt; <span class="dv">10</span>, random =&gt; <span class="dv">0</span>, <span class="fu">reverse</span> =&gt; <span class="dv">1</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  Rectangular block with user specified PRNG starting seed</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>sp_select_block (size =&gt; [<span class="dv">300</span>, <span class="dv">500</span>], count =&gt; <span class="dv">1</span>, prng_seed =&gt; <span class="dv">454678</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower memory footprint (but longer running times for neighbour searches)</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>sp_select_block (size =&gt; <span class="dv">500</span>, count =&gt; <span class="dv">2</span>, clear_cache =&gt; <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_select_element" class="level3">
<h3 class="anchored" data-anchor-id="sp_select_element">sp_select_element</h3>
<p>Select a specific element. Basically the same as sp_match_text, but with optimisations enabled</p>
<p><strong>Required args:</strong> element</p>
<p><strong>Optional args:</strong> type</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># match where the whole coordinate ID (element name)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># is 'Biome1:savannah forest'</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sp_select_element (element =&gt; <span class="ot">'</span><span class="ss">Biome1:savannah forest</span><span class="ot">'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_select_sequence" class="level3">
<h3 class="anchored" data-anchor-id="sp_select_sequence">sp_select_sequence</h3>
<p>Select a subset of all available neighbours based on a sample sequence (note that groups are sorted south-west to north-east)</p>
<p><strong>Required args:</strong> frequency</p>
<p><strong>Optional args:</strong> cycle_offset, first_offset, reverse_order, use_cache</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select every tenth group (groups are sorted alphabetically)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sp_select_sequence (frequency =&gt; <span class="dv">10</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  Select every tenth group, starting from the third</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>sp_select_sequence (frequency =&gt; <span class="dv">10</span>, first_offset =&gt; <span class="dv">2</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  Select every tenth group, starting from the third last</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  and working backwards</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>sp_select_sequence (</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    frequency     =&gt; <span class="dv">10</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    first_offset  =&gt;  <span class="dv">2</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    reverse_order =&gt;  <span class="dv">1</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_self_only" class="level3">
<h3 class="anchored" data-anchor-id="sp_self_only">sp_self_only</h3>
<p>Select only the processing group</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> <em>none</em></p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sp_self_only() <span class="co">#  only use the proceessing cell</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_spatial_output_passed_defq" class="level3">
<h3 class="anchored" data-anchor-id="sp_spatial_output_passed_defq">sp_spatial_output_passed_defq</h3>
<p>Returns 1 if an element passed the definition query for a previously calculated spatial output</p>
<p><strong>Required args:</strong> <em>none</em></p>
<p><strong>Optional args:</strong> element, output</p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Used for spatial or cluster type analyses:</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  The simplest case is where the current</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  analysis includes a def query and you</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  want to use it in a spatial condition.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>sp_spatial_output_passed_defq();</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  Using another output in this basedata</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  In this case the output is called 'analysis1'</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>sp_spatial_output_passed_defq(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    output =&gt; <span class="ot">'</span><span class="ss">analysis1</span><span class="ot">'</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  Return true if a specific element passed the def query</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>sp_spatial_output_passed_defq(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    element =&gt; <span class="ot">'</span><span class="ss">153.5:-32.5</span><span class="ot">'</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_square" class="level3">
<h3 class="anchored" data-anchor-id="sp_square">sp_square</h3>
<p>An overlapping square assessed against all dimensions (more properly called a hypercube). Uses group (map) distances.</p>
<p><strong>Required args:</strong> size</p>
<p><strong>Optional args:</strong> <em>none</em></p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  An overlapping square, cube or hypercube</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  depending on the number of axes</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   Note - you cannot yet specify which axes to use</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   so it will be square on all sides</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sp_square (size =&gt; <span class="dv">300000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sp_square_cell" class="level3">
<h3 class="anchored" data-anchor-id="sp_square_cell">sp_square_cell</h3>
<p>A square assessed against all dimensions (more properly called a hypercube). Uses 'cell' distances.</p>
<p><strong>Required args:</strong> size</p>
<p><strong>Optional args:</strong> <em>none</em></p>
<p><strong>Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sp_square_cell (size =&gt; <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./overview.html" class="pagination-link" aria-label="Overview">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./variables.html" class="pagination-link" aria-label="Variables">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variables</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>